---
layout: post
category: 数学基础
tags: [统计学,数学基础,推断性统计,置信区间,假设检验]
---

推断性统计学 inferential statistics
==============

## 置信区间

### 样本大小与抽样分布

![avatar](https://gwfp.github.io/static/images/19/12/04/Sample.png){:width='340px' height="440px"}

#### 大样本（抽样数大于等于30）

抽样分布符合中心极限定理描述的正态分布

#### 小样本（抽样小于30）

抽样分布符合t分布

### 置信区间的求解步骤

#### 1.确定要求解的问题

#### 2.求样本的平均值和标准误差, 确定置信水平

标准误差SE：

$$
	SE=\frac{\bar{S}}{\sqrt{n}}	
$$
\\( \bar{S} \\) 样本标准差，n 样本大小

置信水平

	常用的置信水平为 95% （两个标准误差）

![avatar](https://gwfp.github.io/static/images/19/12/04/ConfidenceLevel.png){:width='340px' height="280px"}

#### 3.大样本的置信区间(n>30)

确定误差的概率
$$
	P(Z-z_{ \alpha }) = （ 1 - 置信水平 ）/ 2
$$

通过概率P查表确定z值（标准分）

	90% -- 1.64
	95% -- 1.96
	99% -- 2.58

确定上下限的值

![avatar](https://gwfp.github.io/static/images/19/12/04/updownline.png){:width='330px' height="250px"}

	a = 总体平均值 - z  * 标准误差
	b = 总体平均值 + z  * 标准误差	

得到置信区间：[a , b]

#### 4.小样本的置信区间(n<30)

确定自由度 df = n-1 （n为样本大小）

确定检验方式

![avatar](https://gwfp.github.io/static/images/19/12/04/One-tailed.jpg){:width='330px' height="80px"}
	
确定误差概率：
	
	单侧检验：P = 1-置信水平
	双侧检验：P = （1-置信水平)/2

通过概率P和自由度df，查表确定t值（标准分）

确定上下限

	a = 样本平均值 - t * 标准误差
	b = 样本平均值 - t * 标准误差

置信区间(interval): 

	[ a , b ]

code：
	
	from scipy import stats
	interval=stats.t.interval(a,b,mean,std)
 
## 假设检验

> 数理统计学中根据一定假设条件由样本推断总体的一种方法。事先对总体参数或分布形式作出某种假设，然后利用样本信息来判断原假设是否成立，采用逻辑上的反证法，依据统计上的小概率原理。

### 假设检验的求解步骤

#### 1.确定问题是什么

确定检验类型 

	单样本检验
        相关配对检验
        独立双样本检验（AB检验）

确定零假设 \\( H_{0} \\) 和 备选假设 \\( H_{ \alpha } \\)

确定抽样分布类型

	n>30 : 正态分布
	n<30 : 观测图像，型似正态分布 -> t分布，不形似正态分布 -> 其他分布(如卡方分布、F分布等...) -> 不形似任何分布 -> Bootstrpping（对样本重新抽样，可重复抽样）

确定检验方向
	
	单尾检验：左尾
	单位检验：右尾
	双尾检验

#### 2.零假设成立时，得到样本平均值的概率P值。

确定样本标准差：
$$
	SE=\frac{\sigma _{s}}{\sqrt{n}}
$$

确定t值(以单样本t分布为例)：t=（样本值-总体均值）/ 标准误差

根据t值，查找表格，得到 p 值。

#### 3.确定显著水平α（0.1%, 1%, 5%）

#### 4.作出结论

判断假设是否成立：

	p <= α, 拒绝零假设，即备选假设成立。
	p < α, 接受零假设。

确定置信区间（APA格式）

	置信区间的类型.置信水平 置信区间CI=（a,b）
	如：单个样本平均值的置信区间 95% CI=(17.11,17.23)

效应量：
1. Cohen‘d = （第一组平均值-第二组平均值）/ 标准差

效应量Cohen’d的值|显著大小|
-|-
d=0.2|小|
d=0.5|中|
d=0.8|大|

2.相关度指标

$$
	R^{2}=\frac{t^{2}}{t^{2}+df}
$$

t 为t分布中的t值，df为自由度

效应量 \\( R^{2} \\) 的值| 显著大小|
-|-
\\( R^{2} \\)=0.01 | 小 |
\\( R^{2} \\)=0.09 | 中 |
\\( R^{2} \\)=0.25 | 大 |

### 相关配对检验

> 检测相关或配对观测之差(使用前后)的平均值是否等于目标值。

#### 1.问题是什么

##### 设置 \\( H_{0} \\)假设 与 备选 \\( H_{a} \\) 假设

\\( H_{0} \\) = 第一组平均值 - 第二组平均值

##### 判断分布类型

1. n < 30
2. 判断形状：
	import seaborn as sns
	# 查看数据集分布
	sns.distplot(data)
	plt.title('差值数据集分布')
	plt.show()

##### 确定检验方向 

#### 2.证据是什么

##### 计算 \\( H_{0} \\) 假设成立时的平均概率p值。(以t分布为例)

	from scipy import stats
	# t_ci 为t假设检验的t值，p时双尾检验的p值
	t_ci, p_twoTail = stats.ttest_rel(data[0],data[a])
	# 计算单尾检验的p值
	p_oneTail = p_twoTail / 2

#### 3.与确定的显著水平α做比较
	
	α > p_oneTail, 拒绝原假设接受备选假设，犯第Ⅰ 类错误。
	α < p_oneTail，拒绝备选假设接受原假设，犯第Ⅱ 类错误。

#### 4.计算效应量Cohen's d

Cohen‘d = （第一组平均值-第二组平均值）/ 标准差

### 独立双样本检验（A/B测试）

> 样本平均值之差是否等于平均值

#### 1.确定问题是什么

##### 设置 \\( H_{0} \\)假设 与 备选 \\( H_{a} \\) 假设

\\( H_{0} \\) ： A状态下的平均值 = B状态下的平均值
\\( H_{a} \\) ： A状态下的平均值 != B状态下的平均值

...

#### 4.计算效应量Cohen's d

Cohen‘d = （第一组平均值-第二组平均值）/ 合并标准差

$$
	\sigma _{and}=\sqrt{\frac{(n_{1}-1)s_{1}^{2}+(n_{2}-1)s_{2}^{2}}{n_{1}+n_{2}-2}}
$$

\\( \sigma _{and} \\) 是合并标准差。

